---
description: Clean Code ì›ì¹™, ëª…ëª… ê·œì¹™, ë””ìì¸ íŒ¨í„´, ë ˆì´ì–´ë³„ ì½”ë”© ê°€ì´ë“œ, ë¡œê¹… ì „ëµê³¼ ì½”ë“œ í’ˆì§ˆ ê¸°ì¤€ì„ ì œê³µí•©ë‹ˆë‹¤.
globs: 
alwaysApply: false
---
# ğŸ¨ ì½”ë“œ ìŠ¤íƒ€ì¼ ë° í´ë¦° ì½”ë“œ ê·œì¹™

## ğŸŒ ë©”ì‹œì§€ ì •ì±… (í•„ìˆ˜ ì¤€ìˆ˜)
- **ì‹œìŠ¤í…œ ë©”ì‹œì§€**: API ì‘ë‹µ, ì—ëŸ¬ ë©”ì‹œì§€, ë¡œê·¸ â†’ **ì˜ì–´ ì‚¬ìš©**
- **ì½”ë“œ ì£¼ì„**: **í•œêµ­ì–´ ì‚¬ìš©**
- **ì˜ˆì™¸ ë©”ì‹œì§€**: ëª¨ë“  Exception ë©”ì‹œì§€ëŠ” ì˜ì–´
- **ë¡œê·¸ ë©”ì‹œì§€**: log.info(), log.error() ë“± ëª¨ë“  ë¡œê·¸ëŠ” ì˜ì–´

```java
// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ
public class UserService {
    /**
     * ì‚¬ìš©ì ìƒì„± ë©”ì„œë“œ
     * ì´ë©”ì¼ ì¤‘ë³µ ê²€ì¦ í›„ ì‚¬ìš©ìë¥¼ ìƒì„±í•œë‹¤
     */
    public UserResponse createUser(CreateUserRequest request) {
        log.info("Creating user with email: {}", request.getEmail());
        
        if (userRepository.existsByEmail(request.getEmail())) {
            throw DuplicateResourceException.email(request.getEmail()); // ì˜ì–´ ë©”ì‹œì§€
        }
        
        return UserResponse.from(savedUser);
    }
}

// âŒ ì˜ëª»ëœ ì˜ˆ
public UserResponse createUser(CreateUserRequest request) {
    log.info("ì‚¬ìš©ì ìƒì„± ì¤‘: {}", request.getEmail()); // âŒ ë¡œê·¸ëŠ” ì˜ì–´
    
    if (userRepository.existsByEmail(request.getEmail())) {
        throw new RuntimeException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì´ë©”ì¼ì…ë‹ˆë‹¤"); // âŒ ì˜ˆì™¸ëŠ” ì˜ì–´
    }
}
```

## ğŸ¯ í´ë¦° ì½”ë“œ í•µì‹¬ ì›ì¹™

### 1. ëª…ëª… ê·œì¹™ (Naming Convention)
- **í´ë˜ìŠ¤**: `PascalCase` (UserService, AuthController)
- **ë©”ì„œë“œ/ë³€ìˆ˜**: `camelCase` (getUserById, authToken)
- **ìƒìˆ˜**: `UPPER_SNAKE_CASE` (MAX_RETRY_COUNT, JWT_EXPIRATION)
- **íŒ¨í‚¤ì§€**: `lowercase` (user, auth, common)
- **Boolean**: `is/has/can` ì ‘ë‘ì‚¬ (isValid, hasPermission)

### 2. ë©”ì„œë“œ ì‘ì„± ì›ì¹™
- **ë‹¨ì¼ ì±…ì„**: í•˜ë‚˜ì˜ ë©”ì„œë“œëŠ” í•˜ë‚˜ì˜ ì¼ë§Œ
- **ê¸¸ì´ ì œí•œ**: 20ë¼ì¸ ì´ë‚´ (ë³µì¡í•œ ë¡œì§ì€ ë¶„í• )
- **ë§¤ê°œë³€ìˆ˜**: 3ê°œ ì´í•˜ (ì´ˆê³¼ ì‹œ DTO/Builder íŒ¨í„´ ì‚¬ìš©)
- **ì˜ë¯¸ìˆëŠ” ì´ë¦„**: ë©”ì„œë“œëª…ìœ¼ë¡œ ê¸°ëŠ¥ ì¶”ì¸¡ ê°€ëŠ¥

```java
// âœ… ì¢‹ì€ ì˜ˆ
public UserResponse createUser(CreateUserRequest request) {
    validateUserRequest(request);
    User user = buildUserFromRequest(request);
    User savedUser = userRepository.save(user);
    return UserResponse.from(savedUser);
}

// âŒ ë‚˜ìœ ì˜ˆ
public UserResponse doSomething(String a, String b, int c, boolean d) {
    // 50ì¤„ì˜ ë³µì¡í•œ ë¡œì§...
}
```

## ğŸ—ï¸ ë””ìì¸ íŒ¨í„´ ì ìš© ê°€ì´ë“œ

### 1. Builder íŒ¨í„´ (ë³µì¡í•œ ê°ì²´ ìƒì„±)
```java
@Entity
@Builder
@Getter
@NoArgsConstructor
@AllArgsConstructor
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false, unique = true)
    private String email;
    
    @Column(nullable = false)
    private String name;
    
    @Enumerated(EnumType.STRING)
    private UserStatus status;
    
    // ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ
    public void activate() {
        this.status = UserStatus.ACTIVE;
    }
    
    public boolean isActive() {
        return this.status == UserStatus.ACTIVE;
    }
}
```

### 2. Factory íŒ¨í„´ (ê°ì²´ ìƒì„± ë¡œì§ ë¶„ë¦¬)
```java
@Component
public class AuthTokenFactory {
    
    private final JwtUtils jwtUtils;
    
    public AuthTokenFactory(JwtUtils jwtUtils) {
        this.jwtUtils = jwtUtils;
    }
    
    public AuthToken createAccessToken(User user) {
        return AuthToken.builder()
            .token(jwtUtils.generateAccessToken(user))
            .type(TokenType.ACCESS)
            .expiresAt(calculateAccessTokenExpiry())
            .userId(user.getId())
            .build();
    }
    
    public AuthToken createRefreshToken(User user) {
        return AuthToken.builder()
            .token(jwtUtils.generateRefreshToken(user))
            .type(TokenType.REFRESH)
            .expiresAt(calculateRefreshTokenExpiry())
            .userId(user.getId())
            .build();
    }
}
```

### 3. Strategy íŒ¨í„´ (OAuth í´ë¼ì´ì–¸íŠ¸)
```java
public interface OAuthClient {
    String getProviderName();
    OAuthUserInfo getUserInfo(String accessToken);
    boolean supports(OAuthProvider provider);
}

@Component
public class GoogleOAuthClient implements OAuthClient {
    
    @Override
    public String getProviderName() {
        return "google";
    }
    
    @Override
    public OAuthUserInfo getUserInfo(String accessToken) {
        // Google API í˜¸ì¶œ ë¡œì§
    }
    
    @Override
    public boolean supports(OAuthProvider provider) {
        return provider == OAuthProvider.GOOGLE;
    }
}

@Service
public class OAuthService {
    
    private final List<OAuthClient> oauthClients;
    
    public OAuthService(List<OAuthClient> oauthClients) {
        this.oauthClients = oauthClients;
    }
    
    public OAuthUserInfo getUserInfo(OAuthProvider provider, String accessToken) {
        OAuthClient client = oauthClients.stream()
            .filter(c -> c.supports(provider))
            .findFirst()
            .orElseThrow(() -> new UnsupportedOAuthProviderException(provider));
        
        return client.getUserInfo(accessToken);
    }
}
```

## ğŸ“ ë ˆì´ì–´ë³„ ì½”ë”© ê°€ì´ë“œ

### Controller ë ˆì´ì–´
```java
@RestController
@RequestMapping("/api/v1/users")
@RequiredArgsConstructor
@Slf4j
public class UserController {
    
    private final UserService userService;
    
    @PostMapping
    public ResponseEntity<ApiResponse<UserResponse>> createUser(
            @Valid @RequestBody CreateUserRequest request) {
        
        log.info("Creating user with email: {}", request.getEmail());
        
        UserResponse response = userService.createUser(request);
        
        return ResponseEntity.status(HttpStatus.CREATED)
            .body(ApiResponse.success(response));
    }
    
    @GetMapping("/{userId}")
    public ResponseEntity<ApiResponse<UserResponse>> getUser(
            @PathVariable Long userId) {
        
        UserResponse response = userService.getUserById(userId);
        
        return ResponseEntity.ok(ApiResponse.success(response));
    }
}
```

### Service ë ˆì´ì–´
```java
@Service
@RequiredArgsConstructor
@Transactional(readOnly = true)
@Slf4j
public class UserService {
    
    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;
    
    @Transactional
    public UserResponse createUser(CreateUserRequest request) {
        validateEmailNotExists(request.getEmail());
        
        User user = User.builder()
            .email(request.getEmail())
            .name(request.getName())
            .password(passwordEncoder.encode(request.getPassword()))
            .status(UserStatus.ACTIVE)
            .build();
        
        User savedUser = userRepository.save(user);
        
        log.info("User created successfully with ID: {}", savedUser.getId());
        
        return UserResponse.from(savedUser);
    }
    
    public UserResponse getUserById(Long userId) {
        User user = userRepository.findById(userId)
            .orElseThrow(() -> new UserNotFoundException(userId));
        
        return UserResponse.from(user);
    }
    
    private void validateEmailNotExists(String email) {
        if (userRepository.existsByEmail(email)) {
            throw new DuplicateEmailException(email);
        }
    }
}
```

### Repository ë ˆì´ì–´
```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    
    Optional<User> findByEmail(String email);
    
    boolean existsByEmail(String email);
    
    @Query("SELECT u FROM User u WHERE u.status = :status AND u.createdAt >= :since")
    List<User> findActiveUsersSince(@Param("status") UserStatus status, 
                                   @Param("since") LocalDateTime since);
}
```

## ğŸ”§ Lombok í™œìš© ê°€ì´ë“œ

### ê¶Œì¥ ì–´ë…¸í…Œì´ì…˜ ì¡°í•©
```java
// Entity í´ë˜ìŠ¤
@Entity
@Table(name = "users")
@Getter
@Builder
@NoArgsConstructor
@AllArgsConstructor

// DTO í´ë˜ìŠ¤
@Getter
@Builder
@NoArgsConstructor
@AllArgsConstructor
@JsonNaming(PropertyNamingStrategies.SnakeCaseStrategy.class)

// Service/Component í´ë˜ìŠ¤
@Service
@RequiredArgsConstructor
@Slf4j
```

## ğŸš¦ ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´ âœ… ì™„ì„±ë¨

### 1. ErrorCode ì²´ê³„ (ì²œì˜ ìë¦¬)
```java
@Getter
@RequiredArgsConstructor
public enum ErrorCode {
    // í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ (4xxx)
    INVALID_INPUT(4000, HttpStatus.BAD_REQUEST, "Invalid input provided"),
    RESOURCE_NOT_FOUND(4001, HttpStatus.NOT_FOUND, "Resource not found"),
    DUPLICATE_RESOURCE(4002, HttpStatus.CONFLICT, "Resource already exists"),
    
    // ì„œë²„ ì—ëŸ¬ (5xxx)  
    INTERNAL_SERVER_ERROR(5000, HttpStatus.INTERNAL_SERVER_ERROR, "Internal server error"),
    EXTERNAL_SERVICE_ERROR(5001, HttpStatus.BAD_GATEWAY, "External service error");
    
    private final int code;
    private final HttpStatus httpStatus;
    private final String message;
}
```

### 2. í¸ì˜ ë©”ì„œë“œê°€ ìˆëŠ” êµ¬ì²´ ì˜ˆì™¸ë“¤
```java
// ë¦¬ì†ŒìŠ¤ ì—†ìŒ ì˜ˆì™¸ - í¸ì˜ ë©”ì„œë“œ ì œê³µ
public class ResourceNotFoundException extends BusinessException {
    public ResourceNotFoundException(String resource, Object id) {
        super(ErrorCode.RESOURCE_NOT_FOUND, String.format("%s not found with id: %s", resource, id));
    }
    
    // í¸ì˜ ë©”ì„œë“œë“¤
    public static ResourceNotFoundException user(Long userId) {
        return new ResourceNotFoundException("User", userId);
    }
    
    public static ResourceNotFoundException document(String documentId) {
        return new ResourceNotFoundException("Document", documentId);
    }
}

// ì¤‘ë³µ ë¦¬ì†ŒìŠ¤ ì˜ˆì™¸ - í¸ì˜ ë©”ì„œë“œ ì œê³µ
public class DuplicateResourceException extends BusinessException {
    public DuplicateResourceException(String resource, String field, Object value) {
        super(ErrorCode.DUPLICATE_RESOURCE, 
              String.format("%s already exists with %s: %s", resource, field, value));
    }
    
    public static DuplicateResourceException email(String email) {
        return new DuplicateResourceException("User", "email", email);
    }
}
```

### 3. ì¶”ì  IDì™€ ì†ì„± ì¶”ê°€ê°€ ê°€ëŠ¥í•œ BusinessException
```java
public class BusinessException extends RuntimeException {
    private final ErrorCode errorCode;
    private final String traceId;
    private final Map<String, Object> properties;
    
    // ì²´ì´ë‹ ê°€ëŠ¥í•œ ì†ì„± ì¶”ê°€
    public BusinessException addProperty(String key, Object value) {
        this.properties.put(key, value);
        return this;
    }
    
    // êµ¬ì¡°í™”ëœ ë¡œê·¸ ë©”ì‹œì§€
    public String getStructuredMessage() {
        return String.format("[%s] %s (traceId: %s, properties: %s)",
                errorCode.name(), getMessage(), traceId, properties);
    }
}
```

### 4. ì™„ì„±ëœ ê¸€ë¡œë²Œ ì˜ˆì™¸ ì²˜ë¦¬
```java
@RestControllerAdvice
@Slf4j
public class GlobalExceptionHandler {
    
    // í˜„ì¬ëŠ” ê¸°ë³¸ í˜•íƒœë¡œ êµ¬í˜„ë¨ (Spring ì—†ì´ ë¹Œë“œ ê°€ëŠ¥í•˜ë„ë¡)
    // ì¶”í›„ Spring ì„¤ì • ì™„ë£Œ í›„ ì‹¤ì œ ì˜ˆì™¸ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€ ì˜ˆì •
}
```

### 5. ì‚¬ìš©ë²• ì˜ˆì‹œ
```java
@Service
@RequiredArgsConstructor
@Slf4j
public class UserService {
    
    public UserResponse getUserById(Long userId) {
        // í¸ì˜ ë©”ì„œë“œ ì‚¬ìš©
        User user = userRepository.findById(userId)
            .orElseThrow(() -> ResourceNotFoundException.user(userId));
            
        return UserResponse.from(user);
    }
    
    public UserResponse createUser(CreateUserRequest request) {
        // ì¤‘ë³µ ê²€ì¦
        if (userRepository.existsByEmail(request.getEmail())) {
            throw DuplicateResourceException.email(request.getEmail())
                .addProperty("requestId", request.getRequestId())
                .addProperty("timestamp", Instant.now());
        }
        
                // ì •ìƒ ìƒì„± ë¡œì§...
     }
 }
 ```

### 6. í†µì¼ëœ API ì‘ë‹µ í˜•ì‹ âœ… ì™„ì„±ë¨
```java
// ì„±ê³µ ì‘ë‹µ
@GetMapping("/api/v1/users/{userId}")
public ResponseEntity<ApiResponse<UserResponse>> getUser(@PathVariable Long userId) {
    UserResponse user = userService.getUserById(userId);
    return ResponseEntity.ok(ApiResponse.success(user, SuccessCode.USER_RETRIEVED));
}

// í˜ì´ì§• ì‘ë‹µ
@GetMapping("/api/v1/users")
public ResponseEntity<ApiResponse<PageResponse<UserResponse>>> getUsers(Pageable pageable) {
    Page<UserResponse> users = userService.getUsers(pageable);
    PageResponse<UserResponse> pageResponse = PageResponse.from(users);
    return ResponseEntity.ok(ApiResponse.success(pageResponse));
}

// ì‘ë‹µ í˜•ì‹ (JSON)
{
    "success": true,
    "code": 2001,
    "message": "User retrieved successfully",
    "data": { ... },
    "traceId": "550e8400-e29b-41d4-a716-446655440000",
    "timestamp": "2024-06-01T10:30:00Z"
}
```

## ğŸ” ë¡œê¹… ê°€ì´ë“œ

### ë¡œê¹… ë ˆë²¨ ë° ìš©ë„
```java
@Service
@Slf4j
public class UserService {
    
    public void someMethod() {
        // DEBUG: ê°œë°œ ë””ë²„ê¹…ìš©
        log.debug("Processing user data: {}", userData);
        
        // INFO: ì¤‘ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë¡œìš°
        log.info("User {} successfully created", user.getEmail());
        
        // WARN: ì˜ˆìƒ ê°€ëŠ¥í•œ ì˜ˆì™¸ ìƒí™©
        log.warn("Rate limit exceeded for user: {}", userId);
        
        // ERROR: ì˜ˆìƒì¹˜ ëª»í•œ ì‹œìŠ¤í…œ ì˜¤ë¥˜
        log.error("Failed to process payment for user: {}", userId, exception);
    }
}
```

## ğŸš« ì•ˆí‹° íŒ¨í„´ (ê¸ˆì§€ ì‚¬í•­)

### ì½”ë“œ ì‘ì„± ì‹œ í”¼í•´ì•¼ í•  ê²ƒë“¤
```java
// âŒ ë§¤ì§ ë„˜ë²„
if (user.getAge() > 18) { ... }

// âœ… ìƒìˆ˜ ì‚¬ìš©
private static final int ADULT_AGE = 18;
if (user.getAge() > ADULT_AGE) { ... }

// âŒ ê¸´ ë©”ì„œë“œ ì²´ì¸
user.getProfile().getAddress().getCountry().getName().toUpperCase()

// âœ… ì¤‘ê°„ ë³€ìˆ˜ ì‚¬ìš©
Profile profile = user.getProfile();
Address address = profile.getAddress();
Country country = address.getCountry();
String countryName = country.getName().toUpperCase();

// âŒ ì˜ˆì™¸ ë¬´ì‹œ
try {
    // ìœ„í—˜í•œ ì‘ì—…
} catch (Exception e) {
    // ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ
}

// âœ… ì ì ˆí•œ ì˜ˆì™¸ ì²˜ë¦¬
try {
    // ìœ„í—˜í•œ ì‘ì—…
} catch (SpecificException e) {
    log.error("Specific error occurred", e);
    throw new ServiceException("Operation failed", e);
}
```

## ğŸ“š ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ í™•ì¸ ì‚¬í•­
- [ ] ë©”ì„œë“œëª…ì´ ê¸°ëŠ¥ì„ ëª…í™•íˆ í‘œí˜„í•˜ëŠ”ê°€?
- [ ] í•˜ë‚˜ì˜ ë©”ì„œë“œê°€ í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§€ëŠ”ê°€?
- [ ] ë§¤ì§ ë„˜ë²„ë‚˜ í•˜ë“œì½”ë”©ëœ ê°’ì´ ì—†ëŠ”ê°€?
- [ ] ì˜ˆì™¸ ì²˜ë¦¬ê°€ ì ì ˆí•œê°€?
- [ ] ë¡œê¹…ì´ ì ì ˆí•œ ë ˆë²¨ë¡œ ì‘ì„±ë˜ì—ˆëŠ”ê°€?
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì‘ì„±ë˜ì—ˆëŠ”ê°€?
- [ ] ë¬¸ì„œí™”(ì£¼ì„)ê°€ í•„ìš”í•œ ë¶€ë¶„ì— ì‘ì„±ë˜ì—ˆëŠ”ê°€?
